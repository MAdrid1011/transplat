## 可泛化3DGS Encoder加速器设计挑战

可泛化3DGS编码器的执行流程具有两个显著特征：（i）对每个特征图点独立进行深度搜索；（ii）深度预测与高斯生成采用两阶段串行分离的数据流。具体而言，该方法首先对输入的参考图像与目标图像分别进行Backbone特征提取，随后针对参考特征图中的每个像素点，在D个深度假设下将其投影至目标图像，采样对应位置的特征并计算匹配代价，最终选取代价最优的深度作为该像素的估计值；深度搜索完成后，模型通过上采样操作逐像素生成高斯基元。为深入理解该过程的计算特性，我们在Jetson Orin NX（配备2MB L2缓存）平台上部署了当前先进的TranSplat、MVSplat及DepthSplat模型，并针对两个数据集中的各10个场景进行了可泛化3DGS推理实验，识别出两大制约该加速器性能的体系结构挑战：

### Challenge 1：逐点独立深度搜索忽视2D特征空间的语义相似性导致冗余访存

Backbone提取的特征图呈现出一种普遍的统计特性：在二维特征空间中，特征向量相似的像素通常来自同一物体表面，因而其深度值相近。该语义相似性基于两个先验假设：（i）同一物体表面的邻近像素共享相似的纹理、材质及光照条件，导致卷积神经网络提取的特征向量高度相关；（ii）物体表面几何形态通常平滑，深度在局部区域内连续变化。图1(a)的实测数据显示，在TranSplat和MVSplat模型的多个场景推理中，特征余弦相似度超过0.7的像素对对应像素平均占据了总像素数量的51.2%，而其深度一致性平均高达99.46%。而针对使用自监督预训练的DINOv2模型进行特征提取的DepthSplat模型，特征余弦相似度超过0.7的像素对占据了91.4%，其深度一致性高达99.37%。这表明，当像素A与像素B在二维特征空间中语义相似时，A的深度搜索结果对B具有较强的预测能力。

然而，现有系统难以充分利用二维特征空间中的语义复用性。图1(b)的实验结果表明，深度搜索阶段占据DDR内存流量的65%以上，而该阶段的L2缓存命中率平均仅为31.2%，显示其片上缓存数据局部性未被有效利用。深度搜索需要对每个像素在多个深度候选下进行跨视图特征采样与匹配代价计算，访问地址随深度假设和视图索引变化而分散，天然缺乏物理地址局部性，导致频繁的cache line换入换出，但当前硬件仅支持基于物理地址连续性的缓存复用，无法识别二维特征空间中的语义相似关系。由于语义相似的像素在物理地址空间中可能相距甚远，系统仍对每个像素独立执行完整的深度搜索，造成大量本可避免的重复访存，使得深度搜索阶段构成了编码器计算过程中的主要访存瓶颈。


### Challenge 2：深度预测与高斯生成串行数据流忽视3D几何空间的局部连续性导致计算冗余

现有可泛化3DGS编码器普遍采用逐像素高斯生成策略以保持泛化能力，其深度预测与高斯生成两阶段合计平均占据编码器总执行时间的54%，构成推理主要算力开销。然而，以可以有效合并高斯基元的训练式3DGS为基准，在PSNR和SSIM精度损失小于0.1%的条件下，如图2(f)所示，我们测得在多个场景下，仅需平均66942个高斯基元即可表示256×256双视图场景，而可泛化3DGS产出131,072个高斯基元，冗余达1.96倍。为了生成高斯基元，每像素平均需要3,200 FLOPS计算，131,072个像素的完整流水线踪迹平均419M FLOPS，而生成训练式3DGS的高斯基元数量时编码器平均仅需134M FLOPS，平均285M FLOPS（68.1%）消耗于冗余高斯生成。

上述冗余的根源在于两阶段串行数据流对3D集合空间的局部连续性感知：同一表面的相邻像素所生成的高斯基元在位置、协方差及球谐系数等属性上高度一致。我们使用对编码器生成的每个高斯基元的3D近邻域进行了协方差、不透明度和球谐函数相似度的测试，以TranSplat上的Re10k数据集推理（图2(a)）为例，如图2(b)-(e)所示，在多个模型和数据集的高斯场的3D近邻域中，协方差和球谐函数的余弦相似度较大，而不透明度的L2距离较小，这表明用来描述该3D场景的高斯场中，在局部的高斯基元相似度很高。经过统计，在多个模型的多个测试集中，如图2(f)所示，相似的（协方差和球谐函数余弦相似度大于0.7，且不透明度L2距离小于0.2）高斯基元占比超过65%，它们在渲染过程中对最终渲染结果的贡献非常接近，而3DGS的训练过程中往往不会对这些区域扩展出更多高斯基元进行描述，但可泛化3DGS当前的深度预测与高斯生成数据流缺乏能力：当前数据流必须完成全部像素的深度预测后才进入高斯生成，导致了针对图片中大部分区域的深度搜索和高斯基元生成计算都用在了这些冗余高斯基元生成上，构成了编码器计算的主要计算瓶颈。

### 我们的方法

针对上述挑战，我们提出了SCARF，一种面向可泛化3DGS推理的加速架构。SCARF基于二维特征空间的语义相似性与三维场景的局部连续性，在可泛化3DGS编码器加速器中引入两项核心设计技术：

#### 特征相似深度复用（Feature-Similarity Depth Reuse，FSDR）

针对 Challenge 1，FSDR在深度预测数据通路中引入片上语义索引与旁路控制机制，将二维特征空间的语义相似性显式转化为硬件可捕获的复用关系。当像素特征输入深度搜索单元时，FSDR通过轻量级硬件将高维特征映射为低维语义签名，并在单周期内于片上索引表中完成相似项查询；若命中相近语义条目，旁路逻辑直接输出缓存的深度先验，并结合局部空间梯度进行低成本校正，同时通过置信度门控限制异常值传播，确保输出在保持几何连续性的同时避免因误复用带来的失真。该机制将"签名生成—索引匹配—旁路复用"固化于深度搜索数据通路内部，使语义级复用从软件层面的高延迟决策转化为边缘设备上可稳定触发的硬件快速路径，进而在不改变网络结构的前提下同步削减冗余的投影、采样、匹配计算及高访存开销。

#### 场景自适应早停数据流（Scene-Adaptive Early-Stopping Dataflow，SAES）

针对 Challenge 2，我们提出具有在线反馈能力的场景自适应早停数据流 SAES。传统两阶段架构将深度搜索与高斯生成解耦为顺序执行的独立阶段，无法利用已生成高斯的特性指导后续计算。SAES 在数据流中引入跨阶段反馈机制：以瓦片为处理单元，当瓦片内部分像素完成"深度搜索→高斯生成"流水线后，系统在线评估已生成高斯基元在3D几何空间中的相似性；若相似度超过阈值，表明该瓦片对应平滑连续表面，系统立即终止该瓦片剩余像素的后续计算，以已生成的高斯代表整个区域。通过将高斯相似性检测嵌入生成流水线并建立反馈控制通路，SAES 使高连续性区域的冗余计算在产生前即被裁剪，将计算资源集中于真正需要精细处理的几何不连续区域，从而在保持渲染质量的同时显著降低编码器阶段的计算量与能耗。